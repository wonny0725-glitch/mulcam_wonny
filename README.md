# 서울교통공사 지하철 혼잡도 대시보드

서울교통공사 1~8호선의 시간대별 혼잡도 데이터를 시각화하는 Streamlit 대시보드입니다.

## 목차

- [소개](#소개)
- [주요 기능](#주요-기능)
- [설치 및 실행 (Windows)](#설치-및-실행-windows)
- [데이터 파일 준비](#데이터-파일-준비)
- [프로젝트 구조](#프로젝트-구조)
- [문서](#문서)

## 소개

서울교통공사에서 제공하는 지하철 혼잡도 데이터를 기반으로 다음과 같은 분석을 제공합니다:

- 시간대별, 노선별, 역별 혼잡도 분석
- 출근/퇴근 시간대 혼잡도 TOP10 랭킹
- 노선별 비교 차트 및 히트맵
- 데이터 필터링 및 CSV 다운로드

## 주요 기능

- **실시간 필터링**: 요일/호선/방향/역명으로 데이터 필터링
- **혼잡도 랭킹**: 피크/출근평균/퇴근평균 기준 TOP10 역 표시
- **노선별 비교 차트**: 1~8호선의 혼잡도를 한눈에 비교
- **시간대별 히트맵**: 전체 노선의 시간대별 혼잡도를 색상으로 표현
- **역별 시간대별 라인차트**: 특정 역의 시간대별 혼잡도 추이 확인
- **지도 시각화**: 역별 혼잡도를 지도에 표시 (Folium 기반)
- **PDF 보고서 생성**: 버튼 1번으로 전문 보고서 자동 생성
- **CSV 다운로드**: 필터 적용 데이터 및 요약 테이블 다운로드

## 설치 및 실행 (Windows)

### 1. Python 설치 확인

Python 3.8 이상이 설치되어 있어야 합니다.

```powershell
python --version
```

Python이 설치되어 있지 않다면 [Python 공식 사이트](https://www.python.org/downloads/)에서 다운로드하여 설치하세요.

### 2. 프로젝트 폴더로 이동

```powershell
cd C:\mulcam\mulcam_wonny
```

### 3. 의존성 패키지 설치

```powershell
pip install -r requirements.txt
```

설치되는 패키지:
- `streamlit>=1.28.0` - 웹 대시보드 프레임워크
- `pandas>=2.0.0` - 데이터 처리
- `plotly>=5.0.0` - 인터랙티브 차트
- `folium>=0.14.0` - 지도 시각화
- `reportlab>=4.0.0` - PDF 보고서 생성
- `kaleido>=0.2.1` - 차트 이미지 내보내기
- `PyYAML>=6.0` - YAML 설정 관리

### 4. 대시보드 실행

```powershell
streamlit run app.py
```

### 5. 브라우저에서 접속

실행 후 자동으로 브라우저가 열리며, 다음 주소로 접속할 수 있습니다:

```
http://localhost:8501
```

### 종료 방법

터미널(PowerShell)에서 `Ctrl + C`를 누르면 대시보드가 종료됩니다.

## PDF 보고서 생성

대시보드에서 **버튼 하나로 전문 PDF 보고서**를 생성할 수 있습니다.

### 보고서 생성 방법

1. 대시보드 좌측 사이드바에서 필터 조건 선택
2. **"PDF 보고서 생성"** 버튼 클릭
3. 생성 완료 후 **"📥 보고서 다운로드 (PDF)"** 버튼으로 다운로드

### 보고서 주요 내용

- **표지**: 제목, 날짜, 기관명
- **목차**: 보고서 구조 한눈에 확인
- **요약**: 핵심 지표 및 주요 이슈
- **분석 결과**: 호선별/역별 상세 분석
- **개선방안**: 데이터 기반 운영 권고안 (즉시/단기/중기)
- **부록**: 상세 데이터 테이블
- **효과 요약**: 개선 시 기대효과

### 보고서 특징

- ✅ **한글 완벽 지원**: Windows 기본 폰트 자동 감지
- ✅ **전문 양식**: 공공기관 보고서 스타일
- ✅ **자동 생성**: 데이터 기반 권고안 자동 작성
- ✅ **재현 가능**: YAML 스냅샷으로 설정 저장

## 데이터 파일 준비

### CSV 파일 요구사항

- **파일명 형식**: 파일명에 "혼잡도"가 포함되어야 합니다 (예: `서울교통공사_지하철혼잡도정보_20250930.csv`)
- **위치**: 프로젝트 폴더(`C:\mulcam\mulcam_wonny`)에 CSV 파일을 두면 자동으로 인식됩니다
- **날짜 파싱**: 파일명에 `YYYYMMDD` 형식의 날짜가 있으면 기준일로 자동 인식됩니다

### CSV 파일 형식

- **메타 컬럼**: `요일구분`, `호선`, `역번호`, `역명`(또는 `출발역`), `상하선구분`(또는 `상하구분`)
- **시간대 컬럼**: `5시30분`, `6시00분`, ... , `00시30분` (30분 단위)
- **혼잡도 값**: 정원 대비 실제 승차 인원 비율(%)

## 프로젝트 구조

```
mulcam_wonny/
│
├── app.py                              # Streamlit 대시보드 메인 파일
├── data_loader.py                      # 데이터 로딩 및 전처리 모듈
├── requirements.txt                    # 의존성 패키지 목록
├── README.md                           # 프로젝트 설명서 (본 파일)
│
├── FINAL_DASHBOARD_PLAN.md             # 대시보드 구현 계획 (최종본)
├── DASHBOARD_PLAN.md                   # 대시보드 구현 계획 (초안)
│
└── 서울교통공사_지하철혼잡도정보_*.csv  # 혼잡도 데이터 파일
```

## 문서

- **대시보드 구현 계획(최종본)**: [FINAL_DASHBOARD_PLAN.md](FINAL_DASHBOARD_PLAN.md)
  - 프로젝트 전체 페이즈별 구현 계획
  - 완료 이력 및 DoD(Definition of Done)
  
- **대시보드 구현 계획(초안)**: [DASHBOARD_PLAN.md](DASHBOARD_PLAN.md)

## 문제 해결

### 문제: CSV 파일을 찾을 수 없다는 오류

**해결방법**: 프로젝트 폴더에 혼잡도 CSV 파일이 있는지 확인하세요. 파일명에 "혼잡도"가 포함되어야 합니다.

### 문제: 인코딩 오류 발생

**해결방법**: 프로그램은 자동으로 `cp949`, `euc-kr`, `utf-8` 인코딩을 시도합니다. 계속 오류가 발생하면 CSV 파일의 인코딩을 확인하세요.

### 문제: 패키지 설치 오류

**해결방법**: pip를 최신 버전으로 업그레이드하세요.

```powershell
python -m pip install --upgrade pip
```

## 라이센스

이 프로젝트는 교육용 프로젝트입니다.

